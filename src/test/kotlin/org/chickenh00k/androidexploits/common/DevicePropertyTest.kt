package org.chickenh00k.androidexploits.common

import org.chickenh00k.androidexploits.common.Tags.SECURITY_PATCH_TAG
import org.junit.jupiter.api.Assertions
import org.junit.jupiter.api.Assertions.assertTrue
import org.junit.jupiter.api.Test
import java.util.*
import kotlin.collections.ArrayList

class DevicePropertyTest {

    val installerString = "{'installer' :[{\"installer\":\"com.sec.android.easyMover\",\"package\":\"org.chickenhook.startflagexploit\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.google.android.apps.googleassistant\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.jy.game.drawgames\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"de.burgerking.kingfinder\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"de.schildbach.wallet\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.miniclip.minifootball\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.tuxfusion.polizeibericht\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.nakipowerrn\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.lidl.eci.lidlplus\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.tier.app\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.google.android.apps.authenticator2\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.gamma.scan\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.chess.clock\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.silvermoonapps.learnfunthailanguage\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"de.mobilesoftwareag.clevertanken\"},{\"installer\":\"com.samsung.android.app.watchmanager\",\"package\":\"com.samsung.accessory.berrymgr\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.pleco.chinesesystem\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.tpcstld.twozerogame\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.Splitwise.SplitwiseMobile\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"de.kosmos.catan.playitsmartraeuber\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.realvnc.viewer.android\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.yodesoft.android.hanzi_handwriting\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.bilkon.easypiano\"},{\"installer\":\"com.samsung.android.app.watchmanager\",\"package\":\"com.samsung.android.app.watchmanager\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.gesundheitsapplikation.shs\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.google.android.apps.authenticator2.os\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.ai.earlysense.beurer\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.kobil.shift.test\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"jp.eure.android.pairs\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"de.traderepublic.app\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.google.android.music\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.miniclip.footballstrike\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"ch.migrosbank.android.tablet\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.expl.ex\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"de.unister.fluege\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.ldvsmartwifi.smart\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.waddensky.nightshift\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"tv.twitch.android.app\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"org.torproject.torbrowser\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"de.immowelt.android.immobiliensuche\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.paloaltonetworks.globalprotect\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.cupidmedia.wrapper.filipinocupid\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.planet.centerparcs\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"de.bitcoin.android\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.justcodecat.android.learnChinese\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.rovio.baba\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.zdf.android.mediathek\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"de.culture4life.luca\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.kobil.ibb.prod\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.calm.android\"},{\"installer\":\"com.samsung.android.spay\",\"package\":\"com.samsung.android.spayfw\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.jazibkhan.equalizer\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"io.dashcraft.game\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.querdurchdenalltag.logfileviewer\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.kosmos.catanassistant\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"car.pace.drive\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.softwareschiek.ultrapass\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.noctuasoftware.stellarium_free\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"btc.org.freewallet.app\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.samsung.android.waterplugin\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.autoscout24\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"org.nkn.mobile.app\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.kobil.mercan.dev\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"ua.com.streamsoft.pingtools\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.orange.kidspiano.music.songs\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.flowkey.app\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.smappgames.big2\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"de.is24.android\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"screen.mirroring.for_sony_bravia_led_tv.allshare_cast\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.ebay.mobile\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.samourai.wallet\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.kebstudios.calc\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.picsart.draw\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.bitpanda.bitpanda\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"es.hskfree.ap\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.alarmclock.xtreme.free\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.vecturagames.android.app.passwordgenerator\"},{\"installer\":\"com.sec.android.easyMover\",\"package\":\"com.apptiva.logviewer\"}]}"
    @Test
    fun parseInstallers() {
        val properties = ArrayList<DeviceProperty>()
        properties.add(DeviceProperty("INSTALLER", installerString))
        val installers = DeviceProperty.getInstallers(properties)
        println(installers!!)
        assertTrue(installers!!.size > 0)
    }

    @Test
    fun patchOk() {
        val properties =  ArrayList<DeviceProperty>()
        properties.add(DeviceProperty(SECURITY_PATCH_TAG, "2023-02-10"))
        val patchData = DeviceProperty.getSecurityPatchDate(properties)
        Assertions.assertNotNull(patchData)
        println("millis <${patchData!!.toEpochMilliseconds()}>")
    }
}